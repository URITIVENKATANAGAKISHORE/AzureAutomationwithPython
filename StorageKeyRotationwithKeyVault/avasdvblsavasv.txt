# Get the subscription information from management groups
#get_subscription = f"https://management.azure.com/subscriptions/{subscription_id}?api-version=2020-01-01"

get_keyvault = f"https://management.azure.com/subscriptions/{subscription_Id}/resourceGroups/{resource_groupname}/providers/Microsoft.KeyVault/vaults/{Key_vaultName}?api-version=2022-07-01"
response = requests.get(get_keyvault, headers=headers).json()

vaultBaseUrl = response.vaultUri 

get_secrets = f"{vaultBaseUrl}/secrets?api-version=7.3"
#get_secret = f"{vaultBaseUrl}/secrets/{secret_name}/{secret_version}?api-version=7.3"

response = requests.get(get_secrets, headers=headers).json()
response.created
response.exp

get_storageKeys = f"https://management.azure.com/subscriptions/{subscription_Id}/resourceGroups/{resource_groupname}/providers/Microsoft.Storage/storageAccounts/{storage_accountName}/listKeys?api-version=2022-05-01"
response = requests.get(get_storageKeys, headers=headers).json()


for keyName in response.keys.keyName :
    
    create_secret =  f"{vaultBaseUrl}/secrets/{secret_name}?api-version=7.3"
    data = json.dumps({
        "value": "mysecretvalue"
    })
    response = requests.put(create_secret, headers=headers, data=data).json()   